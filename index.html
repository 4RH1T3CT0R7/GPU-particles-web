<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com; script-src 'self'" />
    <title>GPU Particle Shapes</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" />
    <style>
    :root {
      color-scheme: dark;
      --glass: rgba(10, 15, 25, 0.58);
      --glass-strong: rgba(14, 24, 43, 0.9);
      --text: #e9f1ff;
      --muted: rgba(223, 237, 255, 0.8);
      --accent: linear-gradient(135deg, #7af5ff 0%, #8ba6ff 35%, #e196ff 100%);
      --panel-shadow: 0 26px 64px rgba(0, 0, 0, 0.55), inset 0 1px 0 rgba(255, 255, 255, 0.05);
      --card-border: rgba(114, 201, 255, 0.22);
      --chip-bg: rgba(255, 255, 255, 0.04);
      --preview-gradient: linear-gradient(90deg, #7dd8ff, #c9a5ff);
    }
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      background:
        radial-gradient(circle at 18% 20%, rgba(120, 255, 255, 0.09), transparent 30%),
        radial-gradient(circle at 82% 24%, rgba(255, 170, 250, 0.1), transparent 32%),
        radial-gradient(circle at 50% 70%, rgba(120, 170, 255, 0.08), transparent 32%),
        linear-gradient(180deg, #050913 0%, #050a16 35%, #03060d 70%, #03040a 100%);
      color: var(--text);
      font-family: "Space Grotesk", "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      letter-spacing: 0.015em;
      -webkit-font-smoothing: antialiased;
    }
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background:
        radial-gradient(circle at 20% 80%, rgba(80, 219, 255, 0.08), transparent 32%),
        linear-gradient(120deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0)),
        repeating-linear-gradient(90deg, rgba(255, 255, 255, 0.02) 0px, rgba(255, 255, 255, 0.02) 1px, transparent 1px, transparent 40px),
        repeating-linear-gradient(0deg, rgba(255, 255, 255, 0.02) 0px, rgba(255, 255, 255, 0.02) 1px, transparent 1px, transparent 40px);
      pointer-events: none;
    }
    canvas#gl {
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      display: block;
    }
    #controls {
      position: fixed;
      top: 20px;
      left: 20px;
      max-width: 340px;
      max-height: calc(100vh - 40px);
      overflow-y: auto;
      background: linear-gradient(165deg, rgba(12, 20, 35, 0.92), rgba(8, 14, 28, 0.88));
      border: 1px solid rgba(106, 243, 255, 0.18);
      border-radius: 18px;
      padding: 20px 18px 18px;
      font-size: 12px;
      backdrop-filter: blur(24px) saturate(180%);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5), 0 0 40px rgba(106, 243, 255, 0.08), inset 0 1px 0 rgba(255, 255, 255, 0.04);
      z-index: 10;
    }
    #controls::-webkit-scrollbar {
      width: 6px;
    }
    #controls::-webkit-scrollbar-track {
      background: rgba(106, 243, 255, 0.05);
      border-radius: 3px;
    }
    #controls::-webkit-scrollbar-thumb {
      background: linear-gradient(180deg, rgba(106, 243, 255, 0.3), rgba(174, 123, 255, 0.2));
      border-radius: 3px;
    }
    #controls::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 18px;
      padding: 1px;
      background: linear-gradient(135deg, rgba(106, 243, 255, 0.25), rgba(174, 123, 255, 0.15), rgba(106, 243, 255, 0.1));
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask-composite: exclude;
      pointer-events: none;
    }
    .panel-header {
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }
    #controls h3 {
      margin: 0;
      font-size: 16px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #f7fcff;
      display: flex;
      align-items: center;
      gap: 10px;
      background: var(--accent);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      color: transparent;
    }
    #controls h3::before {
      content: "";
      width: 13px;
      height: 13px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 18px rgba(106, 243, 255, 0.8), 0 0 36px rgba(174, 123, 255, 0.65);
    }
    .subtitle {
      margin: -4px 0 14px;
      color: var(--muted);
      font-size: 11.5px;
      letter-spacing: 0.03em;
      line-height: 1.45;
    }
    .badge {
      padding: 7px 10px;
      border-radius: 12px;
      border: 1px solid var(--card-border);
      background: rgba(140, 200, 255, 0.08);
      font-size: 11px;
      letter-spacing: 0.04em;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: #d8ebff;
      text-transform: uppercase;
    }
    .badge::before {
      content: "●";
      font-size: 10px;
      color: #9bf7ff;
      filter: drop-shadow(0 0 6px rgba(154, 244, 255, 0.65));
    }
    .section {
      border-top: 1px solid rgba(106, 243, 255, 0.1);
      padding-top: 16px;
      margin-top: 16px;
      position: relative;
      background: linear-gradient(180deg, rgba(106, 243, 255, 0.02), transparent 80%);
      border-radius: 14px;
      padding: 16px 12px 12px;
    }
    .section:first-of-type {
      border-top: none;
      padding-top: 6px;
      margin-top: 4px;
    }
    .section::before {
      content: "";
      position: absolute;
      top: -1px;
      left: 0;
      width: 100px;
      height: 2px;
      background: linear-gradient(90deg, rgba(106, 243, 255, 0.6), rgba(174, 123, 255, 0.3), transparent);
      border-radius: 1px;
    }
    .section:first-of-type::before { display: none; }
    .section-title {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: #a8d8ff;
      margin: 0 0 12px;
      display: flex;
      align-items: center;
      gap: 10px;
      text-shadow: 0 0 20px rgba(106, 243, 255, 0.3);
    }
    .section-title::before {
      content: "";
      width: 4px;
      height: 4px;
      background: linear-gradient(135deg, #7af5ff, #c8a8ff);
      border-radius: 50%;
      box-shadow: 0 0 8px rgba(106, 243, 255, 0.6);
    }
    .section-title::after {
      content: "";
      flex: 1;
      height: 1px;
      background: linear-gradient(90deg, rgba(174, 123, 255, 0.4), rgba(106, 243, 255, 0.1), transparent);
    }
    .hint {
      display: flex;
      align-items: center;
      gap: 8px;
      color: rgba(233, 246, 255, 0.85);
      font-size: 11px;
      font-weight: 500;
      margin: 6px 0 10px;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
    }
    .hint::before {
      content: "";
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 14px rgba(106, 243, 255, 0.8);
    }
    .control-group {
      margin-bottom: 15px;
    }
    .control-group label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
      color: #ffffff;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: none;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
    }
    .shape-buttons {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
      margin-bottom: 8px;
    }
    button {
      padding: 11px 14px;
      background: linear-gradient(160deg, rgba(20, 35, 60, 0.95), rgba(15, 25, 45, 0.9));
      border: 1.5px solid rgba(106, 243, 255, 0.35);
      color: #e8f4ff;
      border-radius: 10px;
      cursor: pointer;
      font-size: 12px;
      text-transform: none;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      font-weight: 600;
      letter-spacing: 0.03em;
      backdrop-filter: blur(12px);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.35), inset 0 1px 0 rgba(255, 255, 255, 0.08);
      position: relative;
      overflow: hidden;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
    }
    button::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.06), transparent);
      pointer-events: none;
    }
    button::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(120deg, rgba(106, 243, 255, 0.15), rgba(174, 123, 255, 0.12));
      opacity: 0;
      transition: opacity 0.25s ease;
      pointer-events: none;
    }
    button:hover {
      background: linear-gradient(160deg, rgba(30, 50, 80, 0.95), rgba(20, 35, 60, 0.9));
      border-color: rgba(106, 243, 255, 0.6);
      box-shadow: 0 6px 24px rgba(0, 0, 0, 0.4), 0 0 20px rgba(106, 243, 255, 0.25);
      transform: translateY(-1px);
      color: #ffffff;
    }
    button:hover::after { opacity: 1; }
    button:active {
      transform: translateY(0);
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.35);
    }
    button.active {
      background: linear-gradient(160deg, rgba(80, 180, 220, 0.35), rgba(140, 100, 200, 0.3));
      color: #ffffff;
      border-color: rgba(106, 243, 255, 0.85);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 0 25px rgba(106, 243, 255, 0.4);
      text-shadow: 0 0 12px rgba(106, 243, 255, 0.6), 0 1px 2px rgba(0, 0, 0, 0.3);
      font-weight: 700;
    }
    select {
      width: 100%;
      padding: 10px 14px;
      background: linear-gradient(160deg, rgba(18, 30, 50, 0.95), rgba(12, 22, 40, 0.9));
      border: 1.5px solid rgba(106, 243, 255, 0.3);
      color: #e8f4ff;
      border-radius: 10px;
      font-size: 12px;
      font-weight: 500;
      outline: none;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25), inset 0 1px 0 rgba(255, 255, 255, 0.06);
      cursor: pointer;
      transition: all 0.25s ease;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%236af3ff' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      padding-right: 36px;
    }
    select:hover {
      border-color: rgba(106, 243, 255, 0.55);
      background-color: rgba(20, 35, 55, 0.95);
    }
    select:focus {
      border-color: rgba(106, 243, 255, 0.75);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3), 0 0 0 3px rgba(106, 243, 255, 0.12);
    }
    select option {
      background: #0d1a2d;
      color: #e8f4ff;
      padding: 8px;
    }
    input[type="range"] {
      width: 100%;
      margin: 8px 0 6px;
      cursor: pointer;
      accent-color: #6af3ff;
      height: 6px;
      -webkit-appearance: none;
      appearance: none;
      background: linear-gradient(90deg, rgba(106, 243, 255, 0.2), rgba(174, 123, 255, 0.15));
      border-radius: 3px;
      outline: none;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 16px;
      height: 16px;
      background: linear-gradient(135deg, #7af5ff, #a8b8ff);
      border-radius: 50%;
      border: 2px solid rgba(255, 255, 255, 0.3);
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(106, 243, 255, 0.4);
      transition: all 0.2s ease;
    }
    input[type="range"]::-webkit-slider-thumb:hover {
      transform: scale(1.1);
      box-shadow: 0 2px 12px rgba(106, 243, 255, 0.6);
    }
    input[type="range"]::-moz-range-thumb {
      width: 16px;
      height: 16px;
      background: linear-gradient(135deg, #7af5ff, #a8b8ff);
      border-radius: 50%;
      border: 2px solid rgba(255, 255, 255, 0.3);
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(106, 243, 255, 0.4);
    }
    .value-pill {
      background: linear-gradient(135deg, rgba(106, 243, 255, 0.12), rgba(174, 123, 255, 0.08));
      border: 1px solid rgba(106, 243, 255, 0.25);
      color: #d8e8ff;
      padding: 6px 12px;
      border-radius: 8px;
      font-weight: 600;
      font-size: 11px;
      letter-spacing: 0.02em;
      display: inline-flex;
      gap: 5px;
      align-items: center;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }
    .value-pill strong {
      color: #7af5ff;
      font-weight: 700;
      text-shadow: 0 0 8px rgba(106, 243, 255, 0.4);
    }
    .pill-row { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 4px; }
    #manualSpeedGroup {
      border-top: 1px solid rgba(106, 243, 255, 0.14);
      padding-top: 10px;
      margin-top: 10px;
    }
    .palette-row {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .palette-preview {
      flex: 1;
      height: 38px;
      border-radius: 12px;
      border: 1px solid rgba(106, 243, 255, 0.35);
      background: linear-gradient(90deg, rgba(255, 255, 255, 0.35), rgba(255, 255, 255, 0.08));
      position: relative;
      overflow: hidden;
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.18), 0 10px 22px rgba(0, 0, 0, 0.34);
    }
    .palette-preview::after {
      content: "";
      position: absolute;
      inset: 0;
      background: var(--preview-gradient, linear-gradient(90deg, #7dd8ff, #c9a5ff));
      opacity: 0.96;
      filter: saturate(140%);
    }
    .palette-label {
      font-size: 11px;
      color: var(--text);
      letter-spacing: 0.05em;
      min-width: 90px;
      text-transform: uppercase;
    }
    .floating-chips {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 8px;
    }
    .chip {
      background: var(--chip-bg);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 999px;
      padding: 7px 10px;
      font-size: 11px;
      color: #dce8ff;
      display: inline-flex;
      gap: 6px;
      align-items: center;
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.08);
    }
    .chip svg {
      width: 12px;
      height: 12px;
      opacity: 0.9;
    }
    noscript {
      position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%);
      opacity: 0.72; font-size: 14px; letter-spacing: 0.08em;
    }

    /* Mobile Menu Toggle Button */
    #menuToggle {
      display: none;
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 1000;
      width: 50px;
      height: 50px;
      background: linear-gradient(165deg, rgba(12, 20, 35, 0.95), rgba(8, 14, 28, 0.92));
      border: 1.5px solid rgba(106, 243, 255, 0.4);
      border-radius: 12px;
      cursor: pointer;
      padding: 0;
      backdrop-filter: blur(24px) saturate(180%);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6), 0 0 20px rgba(106, 243, 255, 0.15);
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 5px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    #menuToggle:active {
      transform: scale(0.95);
    }

    #menuToggle span {
      display: block;
      width: 24px;
      height: 2.5px;
      background: linear-gradient(90deg, #7af5ff, #a8b8ff);
      border-radius: 2px;
      transition: all 0.3s ease;
      box-shadow: 0 0 8px rgba(106, 243, 255, 0.6);
    }

    #menuToggle.active span:nth-child(1) {
      transform: rotate(45deg) translate(7px, 7px);
    }

    #menuToggle.active span:nth-child(2) {
      opacity: 0;
      transform: scale(0);
    }

    #menuToggle.active span:nth-child(3) {
      transform: rotate(-45deg) translate(7px, -7px);
    }

    /* Mobile Responsive Styles */
    @media (max-width: 768px) {
      #menuToggle {
        display: flex;
      }

      #controls {
        transform: translateX(-100%);
        transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
        max-width: 85vw;
        left: 0;
        top: 0;
        max-height: 100vh;
        border-radius: 0 18px 18px 0;
        padding: 80px 16px 20px;
      }

      #controls.active {
        transform: translateX(0);
        box-shadow: 0 0 60px rgba(0, 0, 0, 0.8), 8px 0 40px rgba(106, 243, 255, 0.15);
      }

      #controls h3 {
        font-size: 14px;
      }

      .subtitle {
        font-size: 10.5px;
      }

      .section-title {
        font-size: 10px;
      }

      .control-group label {
        font-size: 10px;
      }

      button {
        font-size: 11px;
        padding: 10px 12px;
      }

      select {
        font-size: 11px;
        padding: 9px 12px;
      }

      .value-pill {
        font-size: 10px;
        padding: 5px 10px;
      }

      .hint {
        font-size: 10px;
      }

      .chip {
        font-size: 10px;
        padding: 6px 8px;
      }

      .badge {
        font-size: 10px;
        padding: 6px 8px;
      }
    }

    @media (max-width: 480px) {
      #controls {
        max-width: 90vw;
        padding: 80px 14px 18px;
      }

      .shape-buttons {
        grid-template-columns: 1fr;
      }

      button {
        font-size: 10.5px;
        padding: 9px 10px;
      }
    }

    /* Overlay for mobile menu */
    #menuOverlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(4px);
      z-index: 5;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    #menuOverlay.active {
      opacity: 1;
    }

    @media (max-width: 768px) {
      #menuOverlay {
        display: block;
        pointer-events: none;
      }

      #menuOverlay.active {
        pointer-events: all;
      }
    }
  </style>
  <meta name="description" content="Fluid GPU particle cloud morphing between mathematical shapes with trails and glow." />
</head>
<body>
  <canvas id="gl"></canvas>

  <!-- Mobile Menu Toggle Button -->
  <button id="menuToggle" aria-label="Toggle menu">
    <span></span>
    <span></span>
    <span></span>
  </button>

  <!-- Mobile Menu Overlay -->
  <div id="menuOverlay"></div>

  <div id="controls">
    <div class="panel-header">
      <h3>GPU Shapes</h3>
      <div style="display:flex; gap:8px; align-items:center;">
        <button id="langToggle" style="padding:6px 10px; font-size:10px; min-width:45px;">EN</button>
        <span class="badge">Live</span>
      </div>
    </div>
    <div class="subtitle" data-i18n="subtitle">Морфирующий поток частиц с мягким свечением, плавным морфингом и понятными настройками.</div>
    <div class="floating-chips">
      <span class="chip">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="3" ry="3"/><path d="M9 9h6v6H9z"/></svg>
        WebGL2
      </span>
      <span class="chip">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"/><path d="M12 3v18M3 12h18"/></svg>
        3D Shapes
      </span>
      <span class="chip">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12h6l3-9 3 18 3-9h6"/></svg>
        Smooth Trails
      </span>
    </div>
    <div class="section">
      <div class="section-title" data-i18n="shapes_flight">Фигуры и полёт</div>
      <div class="control-group">
        <label data-i18n="shapes">Фигуры</label>
        <div class="shape-buttons" id="shapeButtons"></div>
      </div>

      <div class="control-group">
        <label data-i18n="modes">Режимы</label>
        <div class="shape-buttons">
          <button id="mode-shapes" class="active" data-i18n="mode_shapes">Фигуры</button>
          <button id="mode-free" data-i18n="mode_free">Свободный полёт</button>
          <button id="mode-fractal" data-i18n="mode_fractal">Фракталы</button>
          <button id="mode-equalizer" data-i18n="mode_equalizer">Эквалайзер</button>
        </div>
      </div>
    </div>

    <div class="section">
      <div class="section-title" data-i18n="colors">Цвета</div>
      <div class="control-group">
        <label><span data-i18n="color_count">Количество цветов</span> <span class="value-pill"><strong id="colorCountValue">3 цвета</strong></span></label>
        <input type="range" id="colorCount" min="2" max="6" step="1" value="3">
      </div>
      <div class="control-group">
        <div class="palette-row">
          <div class="palette-preview" id="palettePreview"></div>
          <div class="palette-label" id="paletteLabel">Polar Aurora</div>
          <button id="shufflePalette" data-i18n="shuffle_palette">Сменить палитру</button>
        </div>
      </div>
    </div>

    <div class="section">
      <div class="section-title" data-i18n="shape_morphing">Морфинг фигур</div>
      <div class="control-group">
        <label style="display:flex; align-items:center; gap:8px; text-transform:none; font-weight:600; color:#bdefff;">
          <input type="checkbox" id="autoToggle" checked style="width:15px; height:15px; accent-color:#7ee0ff;">
          <span data-i18n="auto_switch">Автоматически переключать фигуры</span>
        </label>
      </div>

      <div class="control-group">
        <label data-i18n="auto_speed">Скорость автоперехода</label>
        <select id="speedControl">
          <option value="slow" data-i18n-opt="speed_slow">Медленно (20с)</option>
          <option value="normal" selected data-i18n-opt="speed_normal">Нормально (15с)</option>
          <option value="fast" data-i18n-opt="speed_fast">Быстро (6с)</option>
          <option value="manual" data-i18n-opt="speed_custom">Свой вариант</option>
        </select>
      </div>

      <div class="control-group" id="manualSpeedGroup" style="display:none;">
        <label><span data-i18n="custom_transition">Custom transition (seconds)</span> <span class="value-pill"><strong id="speedValue">15s</strong></span></label>
        <input type="range" id="manualSpeed" min="4" max="30" step="0.5" value="15">
      </div>

      <div class="control-group">
        <label><span data-i18n="shape_attraction">Притяжение к фигуре</span> <span class="value-pill"><span data-i18n="force">Сила</span>: <strong id="shapeForceValue">0.95x</strong></span></label>
        <input type="range" id="shapeAttraction" min="0.25" max="1.4" step="0.05" value="0.95">
      </div>
    </div>

    <div class="section">
      <div class="section-title" data-i18n="active_cursor">Активный курсор</div>
      <div class="hint" data-i18n="cursor_hint">ЛКМ — воздействие курсора, ПКМ — вращение камеры</div>
      <div class="control-group">
        <label style="display:flex; align-items:center; gap:8px; text-transform:none; font-weight:600; color:#bdefff;">
          <input type="checkbox" id="cursorActive" checked style="width:15px; height:15px; accent-color:#7ee0ff;">
          <span data-i18n="enable_cursor">Включить курсор</span>
        </label>
          <div class="pill-row">
            <span class="value-pill"><span data-i18n="mode">Режим</span>: <strong id="cursorModeLabel">Притягивать</strong></span>
            <span class="value-pill"><span data-i18n="radius">Радиус</span>: <strong id="cursorRadiusLabel">1.00</strong></span>
          </div>
        </div>

      <div class="control-group">
        <label data-i18n="interaction_type">Тип взаимодействия</label>
        <select id="cursorMode">
          <option value="attract" selected data-i18n-opt="cursor_attract">Притягивать частицы</option>
          <option value="repel" data-i18n-opt="cursor_repel">Отталкивать и разгонять</option>
          <option value="vortex-left" data-i18n-opt="cursor_vortex_left">Вихрь (левый закрут)</option>
          <option value="vortex-right" data-i18n-opt="cursor_vortex_right">Вихрь (правый закрут)</option>
          <option value="pulse" data-i18n-opt="cursor_pulse">Пульсирующий импульс</option>
          <option value="quasar" data-i18n-opt="cursor_quasar">Квазар</option>
          <option value="magnet" data-i18n-opt="cursor_magnet">Магнитный поток</option>
        </select>
      </div>

      <div class="control-group">
        <label><span data-i18n="cursor_strength">Сила курсора</span> <span class="value-pill"><strong id="cursorStrengthValue">1.10x</strong></span></label>
        <input type="range" id="cursorStrength" min="0.25" max="3.0" step="0.05" value="1.10">
      </div>

      <div class="control-group">
        <label><span data-i18n="influence_radius">Радиус влияния</span> <span class="value-pill"><strong id="cursorRadiusValue">1.00</strong></span></label>
        <input type="range" id="cursorRadius" min="0.4" max="2.4" step="0.05" value="1.0">
        <label style="display:flex; align-items:center; gap:8px; margin-top:6px; text-transform:none; font-weight:600; color:#bdefff;">
          <input type="checkbox" id="cursorPulse" checked style="width:15px; height:15px; accent-color:#7ee0ff;">
          <span data-i18n="pulse_on_press">Пульсирующий импульс при зажатии</span>
        </label>
      </div>
    </div>

    <div class="section">
      <div class="section-title" data-i18n="particles">Частицы</div>
      <div class="control-group">
        <label data-i18n="particle_count_label">Количество частиц</label>
        <input type="range" id="particleCount" min="128" max="384" step="64" value="256">
        <div class="pill-row">
          <span class="value-pill">Texture: <strong id="particleTextureLabel">256 × 256</strong></span>
          <span class="value-pill">~<strong id="particleCountValue">65 536</strong> <span data-i18n="particles_word">частиц</span></span>
          <span class="value-pill"><span data-i18n="active">Активно</span>: <strong id="particleCountLabel">65 536</strong></span>
        </div>
      </div>

      <div class="control-group">
        <label><span data-i18n="particle_speed">Скорость частиц</span> <span class="value-pill"><strong id="particleSpeedValue">1.0x</strong></span></label>
        <input type="range" id="particleSpeed" min="0" max="5" step="0.1" value="1">
      </div>

      <div class="control-group">
        <label data-i18n="quick_actions">Быстрые действия</label>
        <div class="shape-buttons">
          <button id="resetFlow" data-i18n="reset">Сбросить</button>
          <button id="scatterFlow" data-i18n="scatter">Разброс / узор</button>
        </div>
      </div>
    </div>

    <div class="section">
      <div class="section-title" data-i18n="audio_reactivity">Аудио-реактивность</div>
      <div class="hint" data-i18n="audio_hint">Работает только в режиме Эквалайзер</div>
      <div class="control-group">
        <label style="display:flex; align-items:center; gap:8px; text-transform:none; font-weight:600; color:#bdefff;">
          <input type="checkbox" id="audioToggle" style="width:15px; height:15px; accent-color:#7ee0ff;">
          <span data-i18n="enable_audio">Включить аудио-реактивность</span>
        </label>
      </div>

      <div class="control-group">
        <label data-i18n="audio_source">Источник звука</label>
        <div class="shape-buttons">
          <button id="useMicrophoneBtn" class="active" data-i18n="use_microphone">Микрофон</button>
          <button id="useAudioFileBtn" data-i18n="load_audio_file">Загрузить файл</button>
        </div>
        <input type="file" id="audioFileInput" accept="audio/*" style="display:none;">
        <audio id="audioElement" style="display:none;" loop></audio>
      </div>

      <div class="control-group" id="audioFileControls" style="display:none;">
        <div style="display:flex; gap:8px; align-items:center; margin-top:8px;">
          <button id="playPauseBtn" style="flex:1;" data-i18n="play">▶ Play</button>
          <button id="stopAudioBtn" style="flex:1;" data-i18n="stop">■ Stop</button>
        </div>
        <div class="pill-row" style="margin-top:8px;">
          <span class="value-pill"><span data-i18n="status">Статус</span>: <strong id="audioStatusLabel">Не загружено</strong></span>
        </div>
      </div>
    </div>

  </div>

  <noscript>This visualization requires JavaScript.</noscript>
  <script type="module" src="./dist/index.js"></script>
</body>
</html>
